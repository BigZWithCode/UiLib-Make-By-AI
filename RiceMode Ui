local Library = {}

function Library:CreateUI()
    local ScreenGui = Instance.new("ScreenGui")
    local MainFrame = Instance.new("Frame")
    local ToggleButton = Instance.new("TextButton")
    local TabsFolder = Instance.new("Folder")

    -- Setup ScreenGui
    ScreenGui.Name = "CustomUILibrary"
    ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    ScreenGui.ResetOnSpawn = false

    -- Setup MainFrame
    MainFrame.Name = "MainFrame"
    MainFrame.Parent = ScreenGui
    MainFrame.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    MainFrame.Size = UDim2.new(0, 400, 0, 300)
    MainFrame.Position = UDim2.new(0.5, -200, 0.5, -150)
    MainFrame.Visible = true

    -- Setup Toggle Button
    ToggleButton.Name = "ToggleButton"
    ToggleButton.Parent = ScreenGui
    ToggleButton.Text = "Toggle Menu"
    ToggleButton.Size = UDim2.new(0, 100, 0, 50)
    ToggleButton.Position = UDim2.new(0, 20, 0, 20)
    ToggleButton.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)

    ToggleButton.MouseButton1Click:Connect(function()
        MainFrame.Visible = not MainFrame.Visible
    end)

    -- Tabs Folder
    TabsFolder.Name = "Tabs"
    TabsFolder.Parent = MainFrame

    return {
        ScreenGui = ScreenGui,
        MainFrame = MainFrame,
        TabsFolder = TabsFolder
    }
end

function Library:AddTab(uiElements, tabName)
    local TabButton = Instance.new("TextButton")
    local TabFrame = Instance.new("Frame")

    -- Tab Button
    TabButton.Name = tabName .. "Button"
    TabButton.Text = tabName
    TabButton.Size = UDim2.new(0, 100, 0, 30)
    TabButton.Parent = uiElements.MainFrame
    TabButton.BackgroundColor3 = Color3.new(0.4, 0.4, 0.4)
    TabButton.Position = UDim2.new(0, #uiElements.TabsFolder:GetChildren() * 110, 0, 0)

    -- Tab Frame
    TabFrame.Name = tabName .. "Frame"
    TabFrame.Size = UDim2.new(1, 0, 1, -40)
    TabFrame.Position = UDim2.new(0, 0, 0, 40)
    TabFrame.Parent = uiElements.TabsFolder
    TabFrame.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
    TabFrame.Visible = false

    TabButton.MouseButton1Click:Connect(function()
        for _, frame in pairs(uiElements.TabsFolder:GetChildren()) do
            frame.Visible = false
        end
        TabFrame.Visible = true
    end)

    return TabFrame
end

function Library:AddToggle(parent, labelText, callback)
    local ToggleFrame = Instance.new("Frame")
    local Label = Instance.new("TextLabel")
    local ToggleButton = Instance.new("TextButton")
    local toggled = false

    ToggleFrame.Size = UDim2.new(1, -10, 0, 30)
    ToggleFrame.BackgroundTransparency = 1
    ToggleFrame.Parent = parent

    Label.Text = labelText
    Label.Size = UDim2.new(0.7, 0, 1, 0)
    Label.BackgroundTransparency = 1
    Label.TextColor3 = Color3.new(1, 1, 1)
    Label.Parent = ToggleFrame

    ToggleButton.Text = "Off"
    ToggleButton.Size = UDim2.new(0.3, 0, 1, 0)
    ToggleButton.Position = UDim2.new(0.7, 0, 0, 0)
    ToggleButton.BackgroundColor3 = Color3.new(0.5, 0.1, 0.1)
    ToggleButton.Parent = ToggleFrame

    ToggleButton.MouseButton1Click:Connect(function()
        toggled = not toggled
        ToggleButton.Text = toggled and "On" or "Off"
        ToggleButton.BackgroundColor3 = toggled and Color3.new(0.1, 0.5, 0.1) or Color3.new(0.5, 0.1, 0.1)
        callback(toggled)
    end)
end

function Library:AddTextButton(parent, labelText, callback)
    local Button = Instance.new("TextButton")

    Button.Text = labelText
    Button.Size = UDim2.new(1, -10, 0, 30)
    Button.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
    Button.TextColor3 = Color3.new(1, 1, 1)
    Button.Parent = parent

    Button.MouseButton1Click:Connect(function()
        callback()
    end)
end

function Library:AddDropdown(parent, labelText, options, callback)
    local DropdownFrame = Instance.new("Frame")
    local Label = Instance.new("TextLabel")
    local DropdownButton = Instance.new("TextButton")
    local DropdownList = Instance.new("Frame")
    local isOpen = false

    DropdownFrame.Size = UDim2.new(1, -10, 0, 30)
    DropdownFrame.BackgroundTransparency = 1
    DropdownFrame.Parent = parent

    Label.Text = labelText
    Label.Size = UDim2.new(0.7, 0, 1, 0)
    Label.BackgroundTransparency = 1
    Label.TextColor3 = Color3.new(1, 1, 1)
    Label.Parent = DropdownFrame

    DropdownButton.Text = "Select"
    DropdownButton.Size = UDim2.new(0.3, 0, 1, 0)
    DropdownButton.Position = UDim2.new(0.7, 0, 0, 0)
    DropdownButton.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
    DropdownButton.Parent = DropdownFrame

    DropdownList.Size = UDim2.new(1, 0, 0, #options * 30)
    DropdownList.Position = UDim2.new(0, 0, 1, 0)
    DropdownList.Visible = false
    DropdownList.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    DropdownList.Parent = DropdownFrame

    for i, option in ipairs(options) do
        local OptionButton = Instance.new("TextButton")
        OptionButton.Text = option
        OptionButton.Size = UDim2.new(1, -10, 0, 30)
        OptionButton.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
        OptionButton.TextColor3 = Color3.new(1, 1, 1)
        OptionButton.Parent = DropdownList

        OptionButton.MouseButton1Click:Connect(function()
            DropdownButton.Text = option
            DropdownList.Visible = false
            isOpen = false
            callback(option)
        end)
    end

    DropdownButton.MouseButton1Click:Connect(function()
        isOpen = not isOpen
        DropdownList.Visible = isOpen
    end)
end

function Library:AddTextInput(parent, labelText, callback)
    local InputFrame = Instance.new("Frame")
    local Label = Instance.new("TextLabel")
    local TextBox = Instance.new("TextBox")

    InputFrame.Size = UDim2.new(1, -10, 0, 30)
    InputFrame.BackgroundTransparency = 1
    InputFrame.Parent = parent

    Label.Text = labelText
    Label.Size = UDim2.new(0.4, 0, 1, 0)
    Label.BackgroundTransparency = 1
    Label.TextColor3 = Color3.new(1, 1, 1)
    Label.Parent = InputFrame

    TextBox.PlaceholderText = "Enter text..."
    TextBox.Size = UDim2.new(0.6, 0, 1, 0)
    TextBox.Position = UDim2.new(0.4, 0, 0, 0)
    TextBox.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
    TextBox.TextColor3 = Color3.new(1, 1, 1)
    TextBox.Parent = InputFrame

    TextBox.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            callback(TextBox.Text)
        end
    end)
end

return Library
